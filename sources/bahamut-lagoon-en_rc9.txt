Lots and lots and lots of script fixes.
